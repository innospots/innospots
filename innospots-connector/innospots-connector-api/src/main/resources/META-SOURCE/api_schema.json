{
  "name": "Http",
  "icon": "/http-api.svg",
  "order": 200,
  "enabled": true,
  "connectType": "API",
  "appNodeType": "io.innospots.workflow.node.app.data.ApiDataNode",
  "overview": "基于HTTP协议的请求连接",
  "description": "请选择此连接支持的鉴权方式并填入连接鉴权的默认值，当组件的“只读”选项被勾选中时，此组件在凭据创建时只展示不能修改。",
  "configs": [
    {
      "name": "Basic",
      "code": "basic-auth-api",
      "minder": "io.innospots.connector.api.minder.BasicAuthApiConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "用户名",
          "name": "user_name",
          "placeholder": "用户名",
          "required": true,
          "labelGrid": 4,
          "tips": "用户名",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "密码",
          "name": "password",
          "placeholder": "密码",
          "required": true,
          "labelGrid": 4,
          "tips": "密码",
          "type": "PASSWORD",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    },
    {
      "name": "Digest",
      "code": "digest-auth-api",
      "minder": "io.innospots.connector.api.minder.DigestAuthApiConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "请求地址",
          "name": "url_address",
          "placeholder": "http://ip:port",
          "required": true,
          "labelGrid": 4,
          "tips": "http://ip:端口",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "digest_realm",
          "name": "digest_realm",
          "placeholder": "",
          "required": true,
          "labelGrid": 4,
          "tips": "digest_realm",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "用户名",
          "name": "user_name",
          "placeholder": "用户名",
          "required": true,
          "labelGrid": 4,
          "tips": "用户名",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "密码",
          "name": "password",
          "placeholder": "密码",
          "required": true,
          "labelGrid": 4,
          "tips": "密码",
          "type": "PASSWORD",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    },
    {
      "name": "Header Auth",
      "code": "header-auth-api",
      "minder": "io.innospots.connector.api.minder.HeaderAuthApiConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "鉴权字段",
          "name": "authority_name",
          "placeholder": "头部鉴权字段",
          "required": true,
          "labelGrid": 4,
          "tips": "字段",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "字段值",
          "name": "authority_value",
          "placeholder": "鉴权字段值",
          "required": true,
          "labelGrid": 4,
          "tips": "字段值",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    },
    {
      "name": "Oauth2",
      "code": "oauth2-auth-api",
      "minder": "io.innospots.connector.api.minder.OAuth2ApiConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "Client ID",
          "name": "client_id",
          "placeholder": "input client id",
          "required": true,
          "labelGrid": 4,
          "tips": "oauth client id",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "Client Secret",
          "name": "client_secret",
          "placeholder": "input client secret",
          "required": true,
          "labelGrid": 4,
          "tips": "Client Secret",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "重定向地址",
          "name": "redirect_address",
          "placeholder": "http://ip:port",
          "required": true,
          "labelGrid": 4,
          "tips": "授权回调的域名或IP地址，不需要指定路径",
          "type": "INPUT",
          "expression": "",
          "gridSize": 8,
          "options": []
        },
        {
          "label": "授权地址",
          "name": "authority_url",
          "placeholder": "http://example.com/oauth2.0/authorize",
          "required": true,
          "labelGrid": 4,
          "tips": "OAuth 2.0 的授权地址",
          "type": "INPUT",
          "expression": "",
          "gridSize": 8,
          "options": []
        },
        {
          "label": "Access Token地址",
          "name": "access_token_url",
          "placeholder": "input access token url",
          "required": true,
          "labelGrid": 4,
          "tips": "OAuth 2.0 使用 Authentication Code 换取 Access Token 的地址",
          "type": "INPUT",
          "expression": "",
          "gridSize": 8,
          "options": []
        },
        {
          "label": "Oauth Scope",
          "name": "oauth_scopes",
          "placeholder": "scopes",
          "required": false,
          "labelGrid": 4,
          "tips": "OAuth 2.0的scopes",
          "type": "INPUT",
          "expression": "",
          "gridSize": 8,
          "options": []
        },
        {
          "label": "token位置",
          "name": "token_location",
          "placeholder": "",
          "required": false,
          "labelGrid": 4,
          "tips": "token 参数在请求头还是请求参数上",
          "type": "RADIO",
          "expression": "",
          "gridSize": 4,
          "options": [
            {"name":"请求头","value":"HEADER"},
            {"name":"请求参数","value":"PARAM"},
            {"name":"请求体","value":"BODY"}
          ]
        },
        {
          "label": "token参数",
          "name": "token_param",
          "placeholder": "请求参数的名称",
          "required": false,
          "labelGrid": 4,
          "tips": "请求参数的名称",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    },
    {
      "name": "Bearer Token",
      "code": "bearer_token",
      "minder": "io.innospots.connector.api.minder.BearerTokenAuthConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "Token",
          "name": "bearer_token",
          "placeholder": "Input token",
          "required": true,
          "labelGrid": 4,
          "tips": "bearer token",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    },
    {
      "name": "Token API",
      "code": "token-auth-api",
      "minder": "io.innospots.connector.api.minder.TokenAuthApiConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "授权地址",
          "name": "access_token_url",
          "placeholder": "http://ip:port",
          "required": true,
          "labelGrid": 4,
          "tips": "请求token的地址",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "请求方法",
          "name": "request_method",
          "placeholder": "",
          "required": true,
          "labelGrid": 4,
          "tips": "GET POST",
          "type": "SELECT",
          "expression": "",
          "gridSize": 4,
          "options": [{
            "name": "GET",
            "value": "GET"
          },{
            "name": "POST",
            "value": "POST"
          }]
        },
        {
          "label": "请求参数",
          "name": "query_param",
          "placeholder": "",
          "required": false,
          "labelGrid": 4,
          "tips": "http query params",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "请求Body",
          "name": "post_body",
          "placeholder": "",
          "required": false,
          "labelGrid": 4,
          "tips": "http post json body",
          "type": "TEXTAREA",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "token位置",
          "name": "token_location",
          "placeholder": "",
          "required": true,
          "labelGrid": 4,
          "tips": "token 参数在请求头还是请求参数上",
          "type": "RADIO",
          "expression": "",
          "gridSize": 4,
          "options": [
            {"name":"请求头","value":"HEADER"},
            {"name":"请求参数","value":"PARAM"},
            {"name":"请求体","value":"BODY"}
          ]
        },
        {
          "label": "token参数",
          "name": "token_param",
          "placeholder": "请求参数的名称",
          "required": true,
          "labelGrid": 4,
          "tips": "请求参数的名称",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "JsonPath",
          "name": "token_json_path",
          "placeholder": "$.data.body",
          "value": "$.data.body",
          "required": false,
          "labelGrid": 4,
          "tips": "返回结果的token所在的JsonPath",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "参数缓存时间(秒)",
          "name": "cache_time",
          "placeholder": "缓存时间，秒",
          "required": false,
          "labelGrid": 4,
          "tips": "参数缓存时间",
          "type": "NUMBER",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    },
    {
      "name": "Oauth2 client",
      "code": "oauth2-client-api",
      "minder": "io.innospots.connector.api.minder.OAuth2ClientConnectionMinder",
      "defaults": {},
      "elements": [
        {
          "label": "授权地址",
          "name": "access_token_url",
          "placeholder": "http://ip:port",
          "required": true,
          "labelGrid": 4,
          "tips": "获取授权的URL地址",
          "type": "INPUT",
          "expression": "",
          "gridSize": 8,
          "options": []
        },
        {
          "label": "grant_type",
          "name": "grant_type",
          "placeholder": "client_credentials",
          "required": true,
          "labelGrid": 4,
          "tips": "grant_type",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "client_id",
          "name": "client_id",
          "placeholder": "输入 client_id",
          "required": true,
          "labelGrid": 4,
          "tips": "oauth2 client模式的client_id",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        },
        {
          "label": "client_secret",
          "name": "client_secret",
          "placeholder": "输入 client_secret",
          "required": true,
          "labelGrid": 4,
          "tips": "oauth2 client模式的client_secret",
          "type": "INPUT",
          "expression": "",
          "gridSize": 4,
          "options": []
        }
      ]
    }
  ],
  "appForm": {
    "type": "object",
    "formWidth": 420,
    "formMinWidth": 360,
    "formMaxWidth": 700,
    "isFixedWidth": false,
    "properties": {
      "displayName": {
        "type": "string",
        "title": "节点名称",
        "required": true,
        "isDefault": true,
        "readOnlyWidget": "ReadOnlyWidget",
        "props": {
          "placeholder": "请输入节点名称"
        },
        "default": "API"
      },
      "auth_type": {
        "type": "string",
        "title": "鉴权方式",
        "required": false,
        "isDefault": true,
        "widget": "AuthSelect",
        "readOnlyWidget": "AuthSelect",
        "props": {
          "placeholder": "请选择鉴权方式"
        },
        "nodeId": 64,
        "options": [{
          "value": "none",
          "label": "None"
        }, {
          "value": "oauth2-auth-api",
          "label": "Oauth2 Auth"
        }, {
          "value": "token-auth-api",
          "label": "Token Auth"
        }]
      },
      "credential": {
        "type": "number",
        "title": "凭据",
        "required": false,
        "isDefault": true,
        "showAddButton": true,
        "showEditButton": true,
        "widget": "CredentialSelect",
        "readOnlyWidget": "CredentialSelect",
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "auth_type",
              "label": "鉴权方式 - auth_type"
            },
            "term": {
              "value": "notnull",
              "label": "有值"
            }
          }]
        }],
        "hidden": "{{!(formData.auth_type != undefined && formData.auth_type != '')}}"
      },
      "url_address": {
        "type": "array",
        "title": "请求地址",
        "required": true,
        "isDefault": true,
        "widget": "HttpURLInput",
        "readOnlyWidget": "HttpURLInput",
        "props": {
          "placeholder": "请输入请求地址"
        }
      },
      "request_params": {
        "title": "HTTP请求",
        "type": "array",
        "widget": "HttpRequest",
        "readOnlyWidget": "HttpRequest",
        "required": false,
        "isSelect": true,
        "dependencies": "url_address"
      },
      "output_payload": {
        "title": "返回数据是否存入Payload",
        "type": "boolean",
        "widget": "switch",
        "default": false,
        "readOnlyWidget": "ReadOnlyWidget",
        "required": false,
        "props": {}
      },
      "switch_cache": {
        "title": "是否缓存",
        "type": "boolean",
        "widget": "switch",
        "default": false,
        "readOnlyWidget": "ReadOnlyWidget",
        "description": "缓存调用结果",
        "required": false,
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "true",
              "label": "选中"
            }
          }]
        }],
        "hidden": "{{!(formData.output_payload == true)}}"
      },
      "cache_second": {
        "title": "缓存时间(秒)",
        "type": "number",
        "readOnlyWidget": "ReadOnlyWidget",
        "required": false,
        "default": 300,
        "props": {
          "addonAfter": "秒",
          "min": 1
        },
        "widgetRules": [{
          "result": "visible",
          "relation": "AND",
          "children": [{
            "source": {
              "value": "switch_cache",
              "label": "是否缓存 - switch_cache"
            },
            "term": {
              "value": "true",
              "label": "选中"
            }
          }, {
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "true",
              "label": "选中"
            }
          }]
        }],
        "hidden": "{{!(formData.switch_cache == true && formData.output_payload == true)}}"
      },
      "extract_path": {
        "title": "数据提取",
        "type": "string",
        "readOnlyWidget": "ReadOnlyWidget",
        "default": "$",
        "required": false,
        "props": {},
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "true",
              "label": "选中"
            }
          }]
        }],
        "hidden": "{{!(formData.output_payload == true)}}"
      },
      "output_field_type": {
        "title": "返回数据类型",
        "type": "string",
        "enum": ["LIST", "MAP"],
        "enumNames": ["列表", "单条(对象)"],
        "widget": "radio",
        "readOnlyWidget": "ReadOnlyWidget",
        "default": "MAP",
        "required": true,
        "props": {
          "optionType": "default"
        },
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "true",
              "label": "选中"
            }
          }]
        }],
        "hidden": "{{!(formData.output_payload == true)}}"
      },
      "output_mode_map": {
        "title": "存储方式",
        "type": "string",
        "options": [{
          "value": "FIELD",
          "label": "存入变量"
        }, {
          "value": "PAYLOAD",
          "label": "合并入Payload"
        }, {
          "value": "OVERWRITE",
          "label": "覆盖Payload"
        }],
        "widget": "Select",
        "readOnlyWidget": "Select",
        "required": true,
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_field_type",
              "label": "返回数据类型 - output_field_type"
            },
            "term": {
              "value": "equals",
              "label": "等于"
            },
            "value": "MAP"
          }]
        }, {
          "result": "hidden",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "false",
              "label": "未选中"
            }
          }]
        }],
        "optionsType": "customOptions",
        "hidden": "{{!(formData.output_field_type == 'MAP') || (formData.output_payload == false || formData.output_payload == undefined)}}"
      },
      "output_mode_list": {
        "title": "存储方式",
        "type": "string",
        "options": [{
          "value": "FIELD",
          "label": "存入变量"
        }, {
          "value": "OVERWRITE",
          "label": "覆盖Payload"
        }],
        "widget": "Select",
        "readOnlyWidget": "Select",
        "required": true,
        "optionsType": "customOptions",
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_field_type",
              "label": "返回数据类型 - output_field_type"
            },
            "term": {
              "value": "equals",
              "label": "等于"
            },
            "value": "LIST"
          }]
        }, {
          "result": "hidden",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "false",
              "label": "未选中"
            }
          }]
        }],
        "hidden": "{{!(formData.output_field_type == 'LIST') || (formData.output_payload == false || formData.output_payload == undefined)}}"
      },
      "variable_name": {
        "title": "存储变量名称",
        "type": "string",
        "readOnlyWidget": "ReadOnlyWidget",
        "required": false,
        "props": {},
        "widgetRules": [{
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_mode_map",
              "label": "存储方式 - output_mode_map"
            },
            "term": {
              "value": "equals",
              "label": "等于"
            },
            "value": "FIELD"
          }]
        }, {
          "result": "visible",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_mode_list",
              "label": "存储方式 - output_mode_list"
            },
            "term": {
              "value": "equals",
              "label": "等于"
            },
            "value": "FIELD"
          }]
        }, {
          "result": "hidden",
          "relation": "OR",
          "children": [{
            "source": {
              "value": "output_payload",
              "label": "返回数据是否存入Payload - output_payload"
            },
            "term": {
              "value": "false",
              "label": "未选中"
            }
          }]
        }],
        "hidden": "{{!(formData.output_mode_map == 'FIELD') || !(formData.output_mode_list == 'FIELD') || (formData.output_payload == false || formData.output_payload == undefined)}}"
      }
    }
  }
}